# 网络

在浏览器输入地址

```
https://www.baidu.com
```

## 网络请求

### 1. 构建请求

浏览器构建请求行：

```
// 请求方法是GET，路径为根路径，HTTP协议版本为1.1
GET / HTTP / 1.1
```

### 2. 查找强缓存

检查强缓存，如果命中就直接使用。没有命中就进入下一步

### 3. DNS解析

输入的是域名，而数据包是通过`IP地址`传递给对方，因此需要使用**DNS**(域名系统)将域名和IP一一映射。

注意：
- 浏览器提供了**DNS强缓存功能**。即一个域名已经解析过了就把解析的结果缓存下来，下一次处理就走缓存，不在解析。
- 不指定端口时，默认采用对应的IP的80端口

### 4. 建立TCP连接

- 注意：Chrome在同一个域名下要求最懂只能有6个TCP连接，超过6个的话剩下的请求就等待。
- TCP建立连接的三个阶段：
    - 1. 同过**三次握手**(即总共发送3个数据包确认已经建立连接)建立客户端和服务器之间的连接。
    - 2. 进行数据传输。注意：接收方接收到数据包后必须要向发送放`确认`，发送方如果没有接到这个`确认`的消息就会判定为数据包丢失，重新发送数据包。同时发送的过程中把`大的数据包拆成一个个小包`，依次传输到接收方，接收方再将小包顺序组装成完整的数据包。
    - 3. 断开连接阶段，数据传输完成，通过**四次挥手**断开连接。

### 5. 发送HTTP请求

建立TCP连接后，浏览器和服务器开始通信，即发送HTTP请求。浏览器携带**请求行**、**请求头**和**请求体**发送HTTP请求。

- 请求行：请求方法、请求URL和HTTP版本协议组成。（构建请求第一步提到）
- 请求头：如，Cache-Control、EXpires、If-Modified-Since、If-None-Match等缓存标识信息，以及一些其他的属性
- 请求体：只有`POST`请求存在请求体，常见于**表单提交**

## 网络响应

HTTP请求到达服务器，服务器进行对应处理。把数据传给浏览器，也就是返回网络响应。响应也分为3个部分：**响应行**、**响应头**和**响应体**。

- 响应行：由`HTTP`协议版本、`状态码`和`状态描述`组成
```
HTTP/1.1  200  OK
```
- 响应头：包含服务器已经返回数据的一些信息，服务器生成数据的时间、返回的数据类型以及对即将写入的Cookie信息
- 响应体
- 响应完之后要判断`Connection`字段，如果请求头或者响应头包含**Connection: Keep-Alive**，表示建立了持久连接，这样`TCP`连接就会一直保持，之后请求统一站点的资源会复用这个连接。否则就断开`TCP`连接。
